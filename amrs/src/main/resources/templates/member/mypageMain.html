<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout.html}">
<head>
<meta charset="UTF-8">
<title>Mypage Main</title>
<style>
a {
	text-decoration: none;
}

table {
	width: 80%;
	margin: 20px auto;
	border-collapse: collapse;
	font-family: 'Arial', sans-serif;
	box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
	overflow: hidden;
}

thead th {
	background-color: #4CAF50;
	color: white;
	text-align: left;
	padding: 12px 15px;
	font-size: 1rem;
}

tbody td {
	padding: 12px 15px;
	border-bottom: 1px solid #ddd;
}

tbody tr:nth-child(odd) {
	background-color: #f9f9f9;
}

tbody tr:nth-child(even) {
	background-color: #ffffff;
}

tbody tr:hover {
	background-color: #f1f1f1;
	cursor: pointer;
}

table {
	border-radius: 10px;
	overflow: hidden;
}

tbody tr:last-child td {
	border-bottom: none;
}

.container-box {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
}

.account-settings {
	width: 40%;
	max-width: 300px;
	padding-top: 2rem;
	padding-bottom: 7rem;
	margin-right: 2rem;
}

.features {
	width: 76%;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-around;
	gap: 30px;
	margin-top: 6rem;
	margin-right: 10rem;
}

.feature {
	flex: 1 1 45%;
	display: inline-block;
	background-color: #fff;
	padding: 30px 10px;
	padding-top: 10px;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
	transition: transform 0.3s ease, box-shadow 0.3s ease;
	border-radius: 12px;
}

.feature:hover {
	transform: translateY(-5px);
	box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.feature h3 {
	margin-top: 0;
	font-size: 1.8em;
	color: #333;
	margin-bottom: 15px;
}

#searchInput {
	background-color: #fff;
	flex: auto;
	border-radius: 10px;
	height: 46px;
	display: flex;
	justify-content: flex-start;
}

.payment-search {
    width: 100%; 
    margin: 20px 0; /* 위아래 여백 추가 */
    display: flex;
    align-items: center;
    position: relative; /* 위치를 조정할 수 있도록 설정 */
}

.payment-search input[type="text"] {
    flex: 1; 
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 10px;
    font-size: 16px;
}

.payment-search i {
    position: absolute;
    right: 10px; /* 돋보기 아이콘을 오른쪽에 위치 */
    color: #555;
    cursor: pointer;
}


.payment-date {
	display: flex;
	justify-content: flex-start;
}

.feature-same-date-ordered {
	display: flex;
	justify-content: space-around;
	background-color: #fff;
	border-radius: 12px;
	border-style: solid;
	border-color: lightgray;
	border-width: 1px;
	align-items: flex-start;
	padding: 15px;
	margin: 10px;
	padding: 15px;
}

.same-date-ordered-info {
	margin: 20px 20px;
}

.order-detail-link {
	margin-left: 748px;
}

.fa-magnifying-glass {
	margin-left: 680px;
	padding: 15px;
}

.fa-bars-staggered:hover {
	cursor: pointer;
	color: #333; /* 원하는 색상으로 변경 가능 */
}

/* .payment-search-placeholder {
	padding: 9px 5px;
	margin-left: 17px;
	font-size: larger;
	width: auto;
	flex: none;
	border: none;
} */

.delete-button-zone {
	margin-left: auto;
	display: flex;
	flex-direction: column; /* 아이콘과 버튼을 세로로 배치 */
	align-items: flex-end; /* 오른쪽 정렬 */
	height: 24vh;
	gap: 136px; /* 아이콘과 버튼 사이 간격 */
}
.payment-info-row{
    width: 100%;
    margin-bottom: 10px;
}
.payment-info {
    display: flex;
    align-items: center;
    min-width: 120px;
    gap: 10px; /* 카테고리와 값 사이 간격 조정 */
}

.payment-info span {
    font-weight: bold;
    flex-shrink: 0;
}

.payment-info p {
	margin: 0;
	text-align: right;
	flex-grow: 1;
}
.payment-date {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.review-button {
    background-color: #007bff;
    color: white;
    padding: 6px 12px;
    border-radius: 5px;
    text-decoration: none;
    font-size: 14px;
}

.review-button:hover {
    background-color: #0056b3;
}

</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const searchInput = document.getElementById("searchInput");
        const features = document.querySelectorAll(".feature");

        searchInput.addEventListener("input", function() {
            const filter = searchInput.value.toLowerCase();

            features.forEach(feature => {
                const titleElement = feature.querySelector("h3");
                if (titleElement) {
                    const titleText = titleElement.textContent.toLowerCase();
                    if (titleText.includes(filter)) {
                        feature.style.display = "block";
                    } else {
                        feature.style.display = "none";
                    }
                }
            });
        });
    });
</script>

</head>
<body>
	<div layout:fragment="content">
		<!-- Profile Section -->
		<div class="login-background">
			<div class="container-box">
				<!-- Account Settings -->
				<div class="account-settings mt-5">
					<table class="noto-serif-kr">
						<tr align="center">
							<td><a th:href="@{/member/mypageMain}">결제내역</a></td>
						</tr>
						<!-- <tr align="center">
							<td>취소/환불내역</td>
						</tr>
						<tr align="center">
							<td>문의하기</td>
						</tr>
						<tr align="center">
							<td>문의내역 확인</td>
						</tr>
						<tr align="center">
							<td>리뷰관리</td>
						</tr> -->
						<tr align="center">
							<td><a th:href="@{/member/checkPassword}">개인정보확인/수정</a></td>
						</tr>
						<!-- <tr align="center">
							<td>결제수단관리</td>
						</tr> -->
					</table>
				</div>

				<!-- Features Section -->
				<div class="features noto-serif-kr">
					<div class="payment-search">
					    <input type="text" id="searchInput" placeholder="결제한 전시를 검색해 보세요!">
					    <i class="fa-solid fa-magnifying-glass"></i>
					</div>
					<div class="feature" th:each="payment : ${paymentList}">
						<div class="payment-date">
							<span th:text="|${#dates.format(payment.createDt, 'yyyy-MM-dd')}에 결제함|"></span>
							<input type="hidden" name="paymentId" th:value="${payment.paymentId}">
							<a th:if="${payment.hasReview}" 
						   th:href="@{/review/reviewDetail/{paymentId}/{reviewId}(paymentId=${payment.paymentId}, reviewId=${payment.reviewId})}"
						   class="btn btn-primary">리뷰조회</a>
							<a th:unless="${payment.hasReview}" 
                   			th:href="@{/review/registerReview/{paymentId}(paymentId=${payment.paymentId})}"
                   			class="btn btn-success">리뷰작성</a>	
						</div>
						<div class="feature-same-date-ordered">
						<a th:href="@{/exhibition/exhibitionDetail/{localId}(localId=${payment.localId})}">
							<img th:src="${payment.exhibitionImage}" 
								class="introduce-card" alt="전시 포스터"
								style="width: 150px; height: 200px;">
						</a>
							<div class="same-date-ordered-info">
								<h3 th:text="${payment.exhibitionTitle}"></h3>
								<hr />
								<div class="payment-info-row">
								<div class="payment-info">
								    <span>관람일</span>
								    <p th:text="${payment.reservDate}"></p>
								</div>
								<div class="payment-info">
								    <span>결제금액</span>
								    <p th:text="|${payment.price}원|"></p>
								</div>
								
								<div class="payment-info">
								    <span>티켓수</span>
								    <p th:text="|${payment.orderCnt}매|"></p>
								</div>
							</div>
							</div>
							<!-- <div class="delete-button-zone">
								<i class="fa-solid fa-bars-staggered"></i>
								<button class="btn btn-create-review">리뷰 작성</button>
							</div> -->
							<!-- 팝업 창 -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>
